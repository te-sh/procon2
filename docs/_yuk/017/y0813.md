---
title: No.813
problem: https://yukicoder.me/problems/no/813
---
逃亡率 $$ p_1 $$, 通過率 $$ q_1 $$ の門 $$ 1 $$ と逃亡率 $$ p_2 $$, 通過率 $$ q_2 $$ の門 $$ 2 $$ について考えると, 門 $$ 1 $$ の手前にいるときの門 $$ 1 $$ の手前に戻ってくる確率 $$ p_{1,2} $$ は,

$$
\begin{align}
p_{1,2} &= p_1 + q_1p_2q_1 + q_1p_2p_1p_2q_1 + \cdots \\
        &= p_1 + q_1^2p_2 \sum_{i=1}^{\infty} (p_1p_2)^{i-1} \\
        &= p_1 + \frac{q_1^2p_2}{1-p_1p_2}
\end{align}
$$

門 $$ 1 $$ の手前にいるときの門 $$ 2 $$ の向こう側に行く確率 $$ q_{1,2} $$ は,

$$
\begin{align}
q_{1,2} &= q_1q_2 + q_1p_2p_1q_2 + q_1p_2p_1p_2p_1q_2 + \cdots \\
        &= q_1q_2 \sum_{i=1}^{\infty} (p_1p_2)^{i-1} \\
        &= \frac{q_1q_2}{1-p_1p_2}
\end{align}
$$

となる. すなわち, 門 $$ 1 $$ と門 $$ 2 $$ は逃亡率 $$ p_{1,2} $$, 通過率 $$ q_{1,2} $$ の1つの門と考えられる.

同様にすべての門を1つの門にまとめたとき, その門の逃亡率が $$ r $$ である.
