---
title: "ARC #050 C"
problem: https://beta.atcoder.jp/contests/arc050/tasks/arc050_c
---
$$ x \geq y $$ とする.

まずは $$ \gcd(x, y) $$ を求める. ユークリッドの互除法を使うと, $$ x \bmod y $$ であるが, 筆算をシミュレートすると `1` が $$ A \bmod B $$ 個並んだ数が残ることが分かる. 以下同様に繰り返すと, $$ \gcd(x, y) $$ は `1` が $$ \gcd(A, B) $$ 個並んだ数となる.

$$ \gcd(x, y) = z, \gcd(A, B) = g $$ とすると,

$$
z = \sum_{i=1}^g 10^{i-1} \\
x = z\sum_{i=1}^{A/g} 10^{(i-1)g} \\
y = z\sum_{i=1}^{B/g} 10^{(i-1)g}
$$

となる. よって,

$$
a = \sum_{i=1}^{A/g} 10^{(i-1)g} \\
b = \sum_{i=1}^{B/g} 10^{(i-1)g}
$$

とおくと, 最小公倍数は,

$$
abz
$$

となる.

この計算であるが, $$ M $$ は素数であるとは限らないので逆元は使えない. そこで,

$$
z = \sum_{i=1}^g 10^{i-1} = \left(\sum_{i=1}^{g/2} 10^{i-1}\right)(10^{g/2}+1)
$$

のように繰り返し2乗法を改良した形で計算する.
