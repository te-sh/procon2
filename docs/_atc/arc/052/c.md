---
title: "ARC #052 C"
problem: https://beta.atcoder.jp/contests/arc052/tasks/arc052_c
---
頂点をタイプBの道を $$ a $$ 本使ってたどりついた場合で分けることを考える. しかしこのままでは頂点数が $$ O(N^2) $$ となり解けない.

ある頂点にタイプBの道を $$ a $$ 本使ってたどりつく場合と $$ b $$ 本使ってたどりつく場合を考える. このときのコストの差が $$ N $$ 以上であれば $$ b $$ 本使ってたどりつく場合は考えなくてもいい. なぜならばその頂点にたどりつくまでにタイプAの道は高々 $$ N-1 $$ 本しか使わないので, コスト差が $$ N $$ 以上であれば $$ b $$ 本使った場合の方が必ずコストが高くなるからである.

数式で表すと以下の通りである.

$$
\frac{b(b+1)}{2}-\frac{a(a+1)}{2} \geq N
$$

よって頂点ごとに $$ a $$ の最小値を求めれば $$ b $$ の上限は上式より $$ O(\sqrt{N}) $$ となるので, あとは Dijkstra 法で解くことができる.
