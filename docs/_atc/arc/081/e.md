---
title: "ARC #081 E"
problem: https://beta.atcoder.jp/contests/arc081/tasks/arc081_c
---
文字列 $$ A $$ の後ろから, すべての文字を含む文字列のうち最短のものを順に取り除いていくことを考える. 全部で $$ K $$ 回取り除けたとすると,

$$
A = A^{\prime} + S_1 + S_2 + \dots + S_K
$$

となる.

このとき, 長さ $$ K $$ の文字列は $$ S_1, S_2, \dots, S_K $$ から一文字ずつ取ればいいので, これは $$ A $$ の部分列である.

そして, 長さ $$ K+1 $$ の文字列 $$ C = c_0c_1\dotsc_K $$ を以下のように取ってみる.

* $$ c_0 $$ は $$ A^{\prime} $$ に含まれない文字である.
* $$ c_1 $$ は $$ S_i $$ の最初の文字とする.

そうすると, これは $$ A $$ の部分文字列でない. これは以下の背理法で証明できる.

* $$ c_0 $$ は $$ A $$ に含まれないので $$ S_1 $$ の中にある.
* $$ c_1 $$ は $$ S_1 $$ の中に1回しか現れない (現れると最短でなくなってしまう) ので, $$ c_0 $$ が $$ S_1 $$ の中にあることから, $$ c_1 $$ は $$ S_2 $$ の中にある.
* 以下これを繰り返すと, 最終的に $$ c_K $$ を決めることができなくなる.

よって, $$ A $$ の部分列でない文字列の最短の長さは $$ K+1 $$ となる.

$$ A $$ の部分列でない文字列の最短の長さが求まったので, 次に辞書順最小の文字列を求める. これは1文字目からできるだけ辞書順に小さい文字を並べていけばいい.

$$ c_i = c $$ とできるかどうかは, $$ c_{i-1} $$ 以降に最初に $$ c $$ が現れる位置を探し, これが $$ S_{i+1} $$ の位置にあればいい. 最初に $$ c $$ が現れる位置は $$ c $$ が現れる位置をあらかじめ計算しておいて二分探索すればいい.
