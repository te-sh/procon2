---
title: "ARC #080 E"
problem: https://atcoder.jp/contests/abc069/tasks/arc080_c
---
最後に取り出す2つが辞書順を決めるので, これがなるべく辞書順で小さくなるようにしたい.

最後に $$ p_i, p_j $$ を取り出すとすると, それまでこの要素には触れられないので, $$ p_1 \dots p_{i-1}, p_{i+1} \dots p_{j-1}, p_{j+1} \dots p_N $$ はそれぞれ独立して拾っていかなければならない. ということはそれぞれのグループは偶数個の要素数でなければならないので, $$ i $$ は奇数, $$ j $$ は偶数である必要がある.

次に取り出すのは, 3つの区間でそれぞれ $$ p_i, p_j $$ を計算してそのうち最も小さいものとなる. そして選んだ区間はさらに3区間に分割される.

以上を効率的に行うように考える.

$$ p_i, p_j $$ の決め方であるが, これは偶数番目と奇数番目の数値をそれぞれ最小値を取るセグメントツリーに突っ込んでおけばいい.

区間ごとに計算して最も小さいものを取得する方法であるが, これは優先順位付きキューを使えばいい.
