---
title: "ARC #083 E"
problem: https://beta.atcoder.jp/contests/arc083/tasks/arc083_c
---
頂点 $$ v $$ について, $$ v $$ を根とする部分木で $$ v $$ と違う色の頂点の重みの合計を $$ Y_v $$ とする.

頂点 $$ v $$ について $$ v $$ の直接の子を $$ u_1, u_2, \dots $$ とする. $$ u_1, u_2, \dots $$ からいくつか選んで $$ v $$ と同じ色にしたとして, その頂点を $$ x_1, x_2, \dots $$, 残りの頂点を $$ y_1, y_2, \dots $$ とすると,

$$
X_v \leq X_{x_1}+X_{y_2}+\dots+Y_{y_1}+Y_{y_2}+\dots
$$

となるような選び方があれば, $$ v $$ は色を塗れる.

$$ X_i $$ は固定なので, $$ Y_i $$ はなるべく小さくする方がいい. よって $$ v $$ の色を決めるときに $$ Y_v $$ が最小になるように選ぶのがいい.

$$ C(i, j) $$ を $$ i $$ 番目の子まで見たときに $$ v $$ と同じ色の重みの合計が $$ j $$ となるときの, $$ v $$ と違う色の重みの合計の最小値を表すとする. このとき,

$$
C(i+1, j) = \min(C(i, j-X_{u_i})+Y_{u_i}, C(i, j-Y_{u_i})+X_{u_i})
$$

という漸化式を立てることができ, DP で求めることができる.

あとはこれを葉から順に計算していけばいい.
