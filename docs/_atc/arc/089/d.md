---
title: "ARC #089 D"
problem: https://beta.atcoder.jp/contests/abc086/tasks/arc089_b
---
$$ s_i $$ が白のときは $$ (x_i+K, y_i) $$ は黒となるので, 以降すべて黒で考える.

また, $$ (x_i, y_i) $$ と $$ (x_i+2K, y_i), (x_i, y_i+2K) $$ は同じ色になるので, $$ x_i, y_i $$ は $$ \bmod 2K $$ で考えていい.

$$ (x_i, y_i) $$ が黒になるためには, 黒の左下が $$ (x_i+1+aK, y_i+1+bK) $$ と $$ (x_i+aK, y_i+bK) $$ で囲まれる正方形の中にあればいい. この正方形の範囲をすべて +1 して, 合計の最大値が答えとなる.

ただし, 正方形の範囲をすべて +1 するのは時間がかかるので, imos法を使って高速化する.
